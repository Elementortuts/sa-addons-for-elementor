
var SAAdvancedMenu = function ($scope, $) {
    var $indicator_class = $(".sa-el-advanced-menu-container", $scope).data(
            "indicator-class"
            );

    var $dropdown_indicator_class = $(
            ".sa-el-advanced-menu-container",
            $scope
            ).data("dropdown-indicator-class");
    var $horizontal = $(".sa-el-advanced-menu", $scope).hasClass(
            "sa-el-advanced-menu-horizontal"
            );

    if ($horizontal) {

        $(".sa-el-advanced-menu > li.menu-item-has-children", $scope).each(
                function () {
                    $("> a", $(this)).append(
                            '<span class="' + $indicator_class + '"></span>'
                            );
                }
        );
        $(".sa-el-advanced-menu > li ul li.menu-item-has-children", $scope).each(
                function () {
                    $("> a", $(this)).append(
                            '<span class="' + $dropdown_indicator_class + '"></span>'
                            );
                }
        );


        $(".sa-el-advanced-menu-horizontal", $scope)
                .before('<span class="sa-el-advanced-menu-toggle-text"></span>')
                .after(
                        '<button class="sa-el-advanced-menu-toggle"><span class="eicon-menu-bar"></span></button>'
                        );


        $(".sa-el-advanced-menu-container", $scope).on(
                "click",
                ".sa-el-advanced-menu-toggle",
                function (e) {
                    e.preventDefault();
                    $(this)
                            .siblings(".sa-el-advanced-menu-horizontal")
                            .css("display") == "none"
                            ? $(this)
                            .siblings(".sa-el-advanced-menu-horizontal")
                            .slideDown(300)
                            : $(this)
                            .siblings(".sa-el-advanced-menu-horizontal")
                            .slideUp(300);
                }
        );

        $(window).on("resize load", function () {
            if (window.matchMedia("(max-width: 991px)").matches) {
                $(".sa-el-advanced-menu-horizontal", $scope).addClass(
                        "sa-el-advanced-menu-responsive"
                        );
                $(".sa-el-advanced-menu-toggle-text", $scope).text(
                        $(
                                ".sa-el-advanced-menu-horizontal .current-menu-item a",
                                $scope
                                )
                        .eq(0)
                        .text()
                        );
            } else {
                $(".sa-el-advanced-menu-horizontal", $scope).removeClass(
                        "sa-el-advanced-menu-responsive"
                        );
                $(
                        ".sa-el-advanced-menu-horizontal, .sa-el-advanced-menu-horizontal ul",
                        $scope
                        ).css("display", "");
            }
        });
    }

    $(".sa-el-advanced-menu > li.menu-item-has-children", $scope).each(
            function () {

                var $height = parseInt($("a", this).css("line-height")) / 2;
                $(this).append(
                        '<span class="sa-el-advanced-menu-indicator ' +
                        $indicator_class +
                        '" style="top:' +
                        $height +
                        'px"></span>'
                        );

            }
    );

    $(".sa-el-advanced-menu > li ul li.menu-item-has-children", $scope).each(
            function (e) {

                var $height = parseInt($("a", this).css("line-height")) / 2;
                $(this).append(
                        '<span class="sa-el-advanced-menu-indicator ' +
                        $dropdown_indicator_class +
                        '" style="top:' +
                        $height +
                        'px"></span>'
                        );

            }
    );


    $(
            ".sa-el-advanced-menu-dropdown-align-left .sa-el-advanced-menu-vertical li.menu-item-has-children"
            ).each(function () {
        var $padding_left = parseInt($("a", $(this)).css("padding-left"));

        $("ul li a", this).css({
            "padding-left": $padding_left + 20 + "px"
        });
    });

    $(
            ".sa-el-advanced-menu-dropdown-align-right .sa-el-advanced-menu-vertical li.menu-item-has-children"
            ).each(function () {
        var $padding_right = parseInt($("a", $(this)).css("padding-right"));

        $("ul li a", this).css({
            "padding-right": $padding_right + 20 + "px"
        });
    });


    $(".sa-el-advanced-menu", $scope).on(
            "click",
            ".sa-el-advanced-menu-indicator",
            function (e) {
                e.preventDefault();
                $(this).toggleClass("sa-el-advanced-menu-indicator-open");
                $(this).hasClass("sa-el-advanced-menu-indicator-open")
                        ? $(this)
                        .siblings("ul")
                        .slideDown(300)
                        : $(this)
                        .siblings("ul")
                        .slideUp(300);
            }
    );
};

jQuery(window).on("elementor/frontend/init", function () {
    elementorFrontend.hooks.addAction(
            "frontend/element_ready/sa-el-advanced-menu.default",
            SAAdvancedMenu
            );
    elementorFrontend.hooks.addAction(
            "frontend/element_ready/sa-el-advanced-menu.skin-one",
            SAAdvancedMenu
            );
    elementorFrontend.hooks.addAction(
            "frontend/element_ready/sa-el-advanced-menu.skin-two",
            SAAdvancedMenu
            );
    elementorFrontend.hooks.addAction(
            "frontend/element_ready/sa-el-advanced-menu.skin-three",
            SAAdvancedMenu
            );
    elementorFrontend.hooks.addAction(
            "frontend/element_ready/sa-el-advanced-menu.skin-four",
            SAAdvancedMenu
            );
    elementorFrontend.hooks.addAction(
            "frontend/element_ready/sa-el-advanced-menu.skin-five",
            SAAdvancedMenu
            );
    elementorFrontend.hooks.addAction(
            "frontend/element_ready/sa-el-advanced-menu.skin-six",
            SAAdvancedMenu
            );
    elementorFrontend.hooks.addAction(
            "frontend/element_ready/sa-el-advanced-menu.skin-seven",
            SAAdvancedMenu
            );
});
